<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeskTalk Settings</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>ðŸŽ¤ DeskTalk Settings</h1>
            <p class="subtitle">Configure your voice transcription assistant â€¢ Status: <span id="engineStatus" class="status-badge">Stopped</span></p>
            <p id="engineError" class="engine-error" style="display: none;"></p>
        </header>

        <div class="tabs">
            <button class="tab-button active" data-tab="general">General</button>
            <button class="tab-button" data-tab="transcription">Transcription</button>
            <button class="tab-button" data-tab="stats">Statistics</button>
            <button class="tab-button" data-tab="license">License</button>
        </div>

        <!-- General Tab -->
        <div class="tab-content active" id="general">
            <div class="section">
                <h2>Push-to-Talk Key</h2>
                <select id="pttKey">
                    <option value="">Select a key...</option>
                </select>
                <!-- <button id="detectKeyBtn" class="btn btn-secondary">Detect Key Press</button> -->
                <p class="hint">Select your push-to-talk key from the dropdown above</p>
            </div>

            <div class="section">
                <h2>Audio Device</h2>
                <select id="audioDevice">
                    <option value="default">Default Device</option>
                </select>
                <button id="refreshDevicesBtn" class="btn btn-secondary">Refresh</button>
            </div>

            <div class="section">
                <h2>Options</h2>
                <label class="checkbox">
                    <input type="checkbox" id="capFirst">
                    <span>Capitalize first letter</span>
                </label>
                <label class="checkbox">
                    <input type="checkbox" id="space">
                    <span>Add space after transcription</span>
                </label>
                <label class="checkbox">
                    <input type="checkbox" id="typeChars">
                    <span>Type characters instead of pasting</span>
                </label>
                <label class="checkbox">
                    <input type="checkbox" id="autoStart">
                    <span>Start with Windows</span>
                </label>
                <label class="checkbox">
                    <input type="checkbox" id="startMinimized">
                    <span>Start minimized to tray</span>
                </label>
                <label class="checkbox">
                    <input type="checkbox" id="darkMode">
                    <span>Dark mode</span>
                </label>
            </div>
            
            <footer>
                <button id="saveBtn" class="btn btn-primary">Save Settings</button>
                <div class="status" id="status"></div>
            </footer>
        </div>

        <!-- Transcription Tab -->
        <div class="tab-content" id="transcription">
            <div class="section">
                <h2>Transcription Mode</h2>
                <label class="radio">
                    <input type="radio" name="transcriptionMode" value="openai" id="modeOpenAI" checked>
                    <span>OpenAI API (Cloud)</span>
                </label>
                <label class="radio">
                    <input type="radio" name="transcriptionMode" value="local" id="modeLocal">
                    <span>Local Model (Offline)</span>
                </label>
            </div>

            <div class="section" id="openaiSection">
                <h2>OpenAI API Key</h2>
                <input type="password" id="apiKey" placeholder="sk-...">
                <button id="validateKeyBtn" class="btn btn-secondary">Validate</button>
                <button id="viewUsageBtn" class="btn btn-secondary">View Usage & Billing</button>
                <p class="hint">Get your API key from <a href="#" id="openaiApiKeysLink">OpenAI</a> â€¢ <a href="#" id="apiKeyVideoLink">Video Tutorial</a></p>
            </div>

            <div class="section" id="localSection" style="display: none;">
                <h2>Local Model</h2>
                <select id="localModel">
                    <option value="">Select a model...</option>
                    <option value="tiny-en">Tiny (English) - Fastest</option>
                    <option value="tiny">Tiny (Multilingual)</option>
                    <option value="base-en">Base (English)</option>
                    <option value="base">Base (Multilingual)</option>
                    <option value="small-en">Small (English)</option>
                    <option value="small">Small (Multilingual)</option>
                    <option value="medium-en">Medium (English)</option>
                    <option value="medium">Medium (Multilingual)</option>
                    <option value="large-v3">Large V3 - Best Quality</option>
                </select>
                <p class="hint">Models will be downloaded on first use</p>
            </div>
            
            <footer>
                <button id="saveBtn2" class="btn btn-primary">Save Settings</button>
                <div class="status" id="status2"></div>
            </footer>
        </div>

        <!-- Statistics Tab -->
        <div class="tab-content" id="stats">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="totalWords">0</div>
                    <div class="stat-label">Total Words</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="avgWPM">0</div>
                    <div class="stat-label">Average WPM</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalTime">0m</div>
                    <div class="stat-label">Recording Time</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="sessionCount">0</div>
                    <div class="stat-label">Sessions</div>
                </div>
            </div>
        </div>

        <!-- License Tab -->
        <div class="tab-content" id="license">
            <div class="section">
                <h2>License Status</h2>
                <div class="license-status">
                    <p><strong>Status:</strong> <span id="licenseStatus">Not Activated</span></p>
                    <p><strong>Plan:</strong> <span id="licensePlan">Trial</span></p>
                    <p id="licenseKeyRow" style="display: none;"><strong>Key:</strong> <span id="licenseKeyDisplay" style="font-family: monospace; color: #666;">â€”</span></p>
                    <p><strong>Expires:</strong> <span id="licenseExpires">â€”</span></p>
                    <p><strong>Devices:</strong> <span id="licenseDevices">â€”</span></p>
                </div>
                <p id="licenseMessage" class="hint status">Enter a license key to unlock DeskTalk Pro features.</p>
            </div>

            <div class="section">
                <h2>Activate License</h2>
                <input type="text" id="licenseKey" placeholder="Enter your license key">
                <button id="activateLicenseBtn" class="btn btn-primary">Activate</button>
                <div class="status" id="licenseStatus3"></div>
            </div>

            <div class="section">
                <button id="buyLicenseBtn" class="btn btn-success">Buy License</button>
                <p class="hint">License key will be sent to your email after purchase</p>
            </div>
            
            <div class="section" id="deactivateSection" style="display: none;">
                <button id="deactivateLicenseBtn" class="btn btn-danger">Deactivate License</button>
                <p class="hint">Remove this license from this device (for testing or switching licenses)</p>
            </div>
        </div>
    </div>

    <script type="module">
        // Test if Tauri is available
        if (window.__TAURI_INTERNALS__) {
            console.log('Tauri API loaded successfully');
        } else if (window.__TAURI__) {
            console.log('Tauri API loaded (legacy)');
        } else {
            console.error('Tauri API not available!');
        }
    </script>
    <script src="app.js"></script>
</body>
</html>
