<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeskTalk Settings</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üé§ DeskTalk Settings</h1>
            <p class="subtitle">Configure your voice transcription assistant ‚Ä¢ Status: <span id="engineStatus" class="status-badge">Stopped</span></p>
            <p id="engineError" class="engine-error" style="display: none;"></p>
        </header>

        <div class="tabs">
            <button class="tab-button active" data-tab="general">General</button>
            <button class="tab-button" data-tab="transcription">Transcription</button>
            <button class="tab-button" data-tab="stats">Statistics</button>
        </div>

        <!-- General Tab -->
        <div class="tab-content active" id="general">
            <div class="section">
                <h2>Push-to-Talk Key</h2>
                <select id="pttKey">
                    <option value="">Select a key...</option>
                </select>
                <!-- <button id="detectKeyBtn" class="btn btn-secondary">Detect Key Press</button> -->
                <p class="hint">Select your push-to-talk key from the dropdown above</p>
            </div>

            <div class="section">
                <h2>Audio Device</h2>
                <select id="audioDevice">
                    <option value="default">Default Device</option>
                </select>
                <button id="refreshDevicesBtn" class="btn btn-secondary">Refresh</button>
            </div>

            <div class="section">
                <h2>Options</h2>
                <label class="checkbox">
                    <input type="checkbox" id="capFirst">
                    <span>Capitalize first letter</span>
                </label>
                <label class="checkbox">
                    <input type="checkbox" id="space">
                    <span>Add space after transcription</span>
                </label>
                <label class="checkbox">
                    <input type="checkbox" id="punctuation">
                    <span>Auto-fix missing punctuation</span>
                    <span class="info-icon" title="If transcription has no periods, question marks, or exclamation points, uses AI to add punctuation. Requires OpenAI API." onclick="event.preventDefault(); event.stopPropagation();">‚ìò</span>
                </label>
                <label class="checkbox">
                    <input type="checkbox" id="typeChars">
                    <span>Type characters instead of pasting</span>
                    <span class="info-icon" title="Slower but works with applications that don't understand Ctrl+V" onclick="event.preventDefault(); event.stopPropagation();">‚ìò</span>
                </label>
                <label class="checkbox">
                    <input type="checkbox" id="autoStart">
                    <span>Start with Windows</span>
                </label>
                <label class="checkbox">
                    <input type="checkbox" id="startMinimized">
                    <span>Start minimized to tray</span>
                </label>
                <label class="checkbox">
                    <input type="checkbox" id="darkMode">
                    <span>Dark mode</span>
                </label>
            </div>
            
            <footer>
                <button id="saveBtn" class="btn btn-primary">Save Settings</button>
                <div class="status" id="status"></div>
            </footer>
        </div>

        <!-- Transcription Tab -->
        <div class="tab-content" id="transcription">
            <div class="section">
                <h2>Transcription Mode</h2>
                <label class="radio">
                    <input type="radio" name="transcriptionMode" value="openai" id="modeOpenAI" checked>
                    <span>OpenAI API (Cloud)</span>
                </label>
                <label class="radio">
                    <input type="radio" name="transcriptionMode" value="local" id="modeLocal">
                    <span>Local Model (Offline)</span>
                </label>
            </div>

            <div class="section" id="openaiSection">
                <h2>OpenAI API Key</h2>
                <input type="password" id="apiKey" placeholder="sk-...">
                <button id="validateKeyBtn" class="btn btn-secondary">Validate</button>
                <button id="viewUsageBtn" class="btn btn-secondary">View Usage & Billing</button>
                <p class="hint">Get your API key from <a href="#" id="openaiApiKeysLink">OpenAI</a> ‚Ä¢ <a href="#" id="apiKeyVideoLink">Video Tutorial</a></p>
            </div>

            <div class="section" id="localSection" style="display: none;">
                <h2>Local Model</h2>
                <select id="localModel">
                    <option value="">Select a model...</option>
                    <option value="tiny-en">Tiny (English) - Fastest</option>
                    <option value="tiny">Tiny (Multilingual)</option>
                    <option value="base-en">Base (English)</option>
                    <option value="base">Base (Multilingual)</option>
                    <option value="small-en">Small (English)</option>
                    <option value="small">Small (Multilingual)</option>
                    <option value="medium-en">Medium (English)</option>
                    <option value="medium">Medium (Multilingual)</option>
                    <option value="large-v3">Large V3 - Best Quality</option>
                </select>
                <p class="hint">Models will be downloaded on first use</p>
            </div>
            
            <footer>
                <button id="saveBtn2" class="btn btn-primary">Save Settings</button>
                <div class="status" id="status2"></div>
            </footer>
        </div>

        <!-- Statistics Tab -->
        <div class="tab-content" id="stats">
            <div class="section typing-speed-section">
                <h2>Your Typing Speed</h2>
                <div class="typing-speed-input-row">
                    <input type="number" id="typingWPM" min="1" max="200" value="40" class="wpm-input">
                    <span class="wpm-label">WPM</span>
                    <a href="#" id="typingTestLink" class="typing-test-link">Don't know? Take a test ‚Üí</a>
                </div>
                <p class="hint">Average typist: 40 WPM ‚Ä¢ Professional: 65-75 WPM</p>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="totalWords">0</div>
                    <div class="stat-label">Total Words</div>
                    <div class="stat-lifetime" id="lifetimeWords">Lifetime: 0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="avgWPM">0</div>
                    <div class="stat-label">Speaking WPM</div>
                    <div class="stat-lifetime" id="lifetimeWPM">Lifetime: 0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalTime">0m</div>
                    <div class="stat-label">Recording Time</div>
                    <div class="stat-lifetime" id="lifetimeTime">Lifetime: 0m</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="sessionCount">0</div>
                    <div class="stat-label">Sessions</div>
                    <div class="stat-lifetime" id="lifetimeSessions">Lifetime: 0</div>
                </div>
                <div class="stat-card stat-card-highlight stat-card-wide">
                    <div class="stat-value" id="timeSaved">0m</div>
                    <div class="stat-label">‚è±Ô∏è Time Saved</div>
                    <div class="stat-lifetime" id="lifetimeTimeSaved">Lifetime: 0m</div>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        // Test if Tauri is available
        if (window.__TAURI_INTERNALS__) {
            console.log('Tauri API loaded successfully');
        } else if (window.__TAURI__) {
            console.log('Tauri API loaded (legacy)');
        } else {
            console.error('Tauri API not available!');
        }
    </script>
    <script src="app.js"></script>
</body>
</html>
